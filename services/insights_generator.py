import os

# --- –¢–£–¢ –ú–ò –í–ò–ó–ù–ê–ß–ê–Ñ–ú–û –ù–ê–®–Ü –ü–†–ê–í–ò–õ–ê ---

# (ER) Engagement Rate (–ø–µ—Ä–µ–≥–ª—è–¥–∏ / –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏)
ER_GOOD = 20.0  # (20% - —Ü–µ –¥—É–∂–µ –¥–æ–±—Ä–µ –¥–ª—è TG)
ER_LOW = 5.0    # (–ù–∏–∂—á–µ 5% - –ø–æ–≥–∞–Ω–æ)

# (RR) Reaction Rate (—Ä–µ–∞–∫—Ü—ñ—ó / –ø–µ—Ä–µ–≥–ª—è–¥–∏) - –Ω–∞—à "–¥–µ—Ç–µ–∫—Ç–æ—Ä –±–æ—Ç—ñ–≤"
RR_GOOD = 10.0  # (10% - —á—É–¥–æ–≤–∞ –∂–∏–≤–∞ –∞—É–¥–∏—Ç–æ—Ä—ñ—è)
RR_LOW = 3.0    # (–ù–∏–∂—á–µ 3% - "Red Flag", –π–º–æ–≤—ñ—Ä–Ω–∞ –Ω–∞–∫—Ä—É—Ç–∫–∞)

# (PPD) Posts Per Day
PPD_HIGH = 7.0  # (–ë—ñ–ª—å—à–µ 7 –ø–æ—Å—Ç—ñ–≤ –Ω–∞ –¥–µ–Ω—å - —Ü–µ —Å–ø–∞–º)
PPD_LOW = 0.5   # (–ú–µ–Ω—à–µ 1 –ø–æ—Å—Ç–∞ –Ω–∞ 2 –¥–Ω—ñ - –Ω–∏–∑—å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å)

# (SPREAD) –†–æ–∑–∫–∏–¥ –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤ (Max / Min)
# --- –û–ù–û–í–õ–ï–ù–û: –¢–µ–ø–µ—Ä –ø–æ—Ä—ñ–≥ 3.0, –∞ –Ω–µ 5.0 ---
SPREAD_HIGH = 3.0 # (–Ø–∫—â–æ –Ω–∞–π–∫—Ä–∞—â–∏–π "–∑—Ä—ñ–ª–∏–π" –ø–æ—Å—Ç —É 3+ —Ä–∞–∑—ñ–≤ –∫—Ä–∞—â–∏–π –∑–∞ –Ω–∞–π–≥—ñ—Ä—à–∏–π - —Ü–µ "Red Flag")

def generate_pro_insights(data: dict) -> list:
    """
    –ê–Ω–∞–ª—ñ–∑—É—î —Å–ª–æ–≤–Ω–∏–∫ 'data' —ñ –ø–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –ø–æ—Ä–∞–¥.
    –ö–æ–∂–Ω–∞ –ø–æ—Ä–∞–¥–∞ - —Ü–µ —Å–ª–æ–≤–Ω–∏–∫: {'type': 'positive'|'warning'|'suggestion', 'text': '...'}
    """
    
    if 'er' not in data or data.get('is_private'):
        return []

    insights = []
    
    # 1. –ê–Ω–∞–ª—ñ–∑ Engagement Rate (ER)
    er = data.get('er', 0)
    if er >= ER_GOOD:
        insights.append({
            'type': 'positive',
            'text': f'–§–∞–Ω—Ç–∞—Å—Ç–∏—á–Ω–∏–π ER ({er:.1f}%). –í–∞—à–∞ –∞—É–¥–∏—Ç–æ—Ä—ñ—è –¥—É–∂–µ –ª–æ—è–ª—å–Ω–∞ —Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ —á–∏—Ç–∞—î –ø–æ—Å—Ç–∏.'
        })
    elif er < ER_LOW:
        insights.append({
            'type': 'warning',
            'text': f'–ù–∏–∑—å–∫–∏–π ER ({er:.1f}%). –ê—É–¥–∏—Ç–æ—Ä—ñ—è –ø–æ–≥–∞–Ω–æ –∑–∞–ª—É—á–µ–Ω–∞. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –æ–∑–Ω–∞–∫–æ—é –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤ (–±–æ—Ç—ñ–≤) –∞–±–æ –Ω–µ—Ü—ñ–∫–∞–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É.'
        })
    else:
        insights.append({
            'type': 'suggestion',
            'text': f'–•–æ—Ä–æ—à–∏–π ER ({er:.1f}%). –©–æ–± –π–æ–≥–æ –ø—ñ–¥–≤–∏—â–∏—Ç–∏, —Å–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –±—ñ–ª—å—à–µ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏—Ö –ø–æ—Å—Ç—ñ–≤ (–æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è, –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∏).'
        })

    # 2. –ê–Ω–∞–ª—ñ–∑ Reaction Rate (RR) - "–î–µ—Ç–µ–∫—Ç–æ—Ä –ë–æ—Ç—ñ–≤"
    rr = data.get('reaction_rate', 0)
    if rr >= RR_GOOD:
        insights.append({
            'type': 'positive',
            'text': f'–ß—É–¥–æ–≤–∏–π –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –†–µ–∞–∫—Ü—ñ–π ({rr:.1f}%). –¶–µ –æ–∑–Ω–∞–∫–∞ –¥—É–∂–µ "–∂–∏–≤–æ—ó" —Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—ó –∞—É–¥–∏—Ç–æ—Ä—ñ—ó. –Ü–Ω–≤–µ—Å—Ç–æ—Ä–∏ —Ü–µ –ª—é–±–ª—è—Ç—å.'
        })
    elif rr < RR_LOW:
        insights.append({
            'type': 'warning',
            'text': f'üö® RED FLAG: –î—É–∂–µ –Ω–∏–∑—å–∫–∏–π –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –†–µ–∞–∫—Ü—ñ–π ({rr:.1f}%). –ü—Ä–∏ –≤–∏—Å–æ–∫–∏—Ö –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ö —Ü–µ —î –≥–æ–ª–æ–≤–Ω–æ—é –æ–∑–Ω–∞–∫–æ—é "–Ω–∞–∫—Ä—É—á–µ–Ω–∏—Ö" –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤ –±–æ—Ç–∞–º–∏.'
        })
    else:
        insights.append({
            'type': 'suggestion',
            'text': f'–•–æ—Ä–æ—à–∏–π RR ({rr:.1f}%). –í–∞—à—ñ –ø–æ—Å—Ç–∏ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å –µ–º–æ—Ü—ñ—ó. –°–ø—Ä–æ–±—É–π—Ç–µ –∞–∫—Ç–∏–≤–Ω—ñ—à–µ –∑–∞–∫–ª–∏–∫–∞—Ç–∏ –¥–æ —Ä–µ–∞–∫—Ü—ñ–π.'
        })

    # 3. –ê–Ω–∞–ª—ñ–∑ –ß–∞—Å—Ç–æ—Ç–∏ –ü–æ—Å—Ç–∏–Ω–≥—É (PPD)
    ppd = data.get('posts_per_day', 0)
    if ppd >= PPD_HIGH:
        insights.append({
            'type': 'warning',
            'text': f'üö® RED FLAG: –î—É–∂–µ –≤–∏—Å–æ–∫–∞ —á–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å—Ç–∏–Ω–≥—É (~{ppd:.1f} –ø–æ—Å—Ç/–¥–µ–Ω—å). –í–∏ —Ä–∏–∑–∏–∫—É—î—Ç–µ "–≤–∏–ø–∞–ª–∏—Ç–∏" –∞—É–¥–∏—Ç–æ—Ä—ñ—é —Ç–∞ –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ —É —Ç—ñ–Ω—å–æ–≤–∏–π –±–∞–Ω –∑–∞ —Å–ø–∞–º.'
        })
    elif ppd < PPD_LOW:
        insights.append({
            'type': 'suggestion',
            'text': f'–ù–∏–∑—å–∫–∞ —á–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å—Ç–∏–Ω–≥—É (~{ppd:.1f} –ø–æ—Å—Ç/–¥–µ–Ω—å). –ê—É–¥–∏—Ç–æ—Ä—ñ—è –º–æ–∂–µ –ø—Ä–æ –≤–∞—Å –∑–∞–±—É—Ç–∏. –ù–∞–º–∞–≥–∞–π—Ç–µ—Å—è –ø–æ—Å—Ç–∏—Ç–∏ —Ö–æ—á–∞ –± 1 —Ä–∞–∑ –Ω–∞ –¥–µ–Ω—å.'
        })

    # 4. –ê–Ω–∞–ª—ñ–∑ –°—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤ (Spread)
    min_v = data.get('min_views', 0)
    max_v = data.get('max_views', 0)
    
    # --- –û–ù–û–í–õ–ï–ù–û: –¢–µ–ø–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ min_v > 0 ---
    if min_v > 0 and (max_v / min_v) >= SPREAD_HIGH:
        spread = max_v / min_v
        insights.append({
            'type': 'warning',
            # --- –û–ù–û–í–õ–ï–ù–û: –î–æ–¥–∞–Ω–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –ø—Ä–æ "–∑—Ä—ñ–ª—ñ" –ø–æ—Å—Ç–∏ ---
            'text': f'üö® RED FLAG: –ù–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ –ø–µ—Ä–µ–≥–ª—è–¥–∏ (—Ä–æ–∑–∫–∏–¥ —É {spread:.1f} —Ä–∞–∑—ñ–≤ —Å–µ—Ä–µ–¥ "–∑—Ä—ñ–ª–∏—Ö" –ø–æ—Å—Ç—ñ–≤ >24 –≥–æ–¥). –¶–µ –º–æ–∂–µ —Å–≤—ñ–¥—á–∏—Ç–∏ –ø—Ä–æ –∫—É–ø—ñ–≤–ª—é –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤ –Ω–∞ –æ–∫—Ä–µ–º—ñ –ø–æ—Å—Ç–∏.'
        })
    elif min_v > 0: # min_v > 0 –æ–∑–Ω–∞—á–∞—î, —â–æ —É –Ω–∞—Å –±—É–ª–∏ "–∑—Ä—ñ–ª—ñ" –ø–æ—Å—Ç–∏
        insights.append({
            'type': 'positive',
            'text': '–°—Ç–∞–±—ñ–ª—å–Ω—ñ –ø–µ—Ä–µ–≥–ª—è–¥–∏ (—Å–µ—Ä–µ–¥ "–∑—Ä—ñ–ª–∏—Ö" –ø–æ—Å—Ç—ñ–≤). –¶–µ —á—É–¥–æ–≤–∞ –æ–∑–Ω–∞–∫–∞ –∑–¥–æ—Ä–æ–≤–æ–≥–æ, "–Ω–µ –Ω–∞–∫—Ä—É—á–µ–Ω–æ–≥–æ" –∫–∞–Ω–∞–ª—É.'
        })
    else:
        # –¶–µ —Å–ø—Ä–∞—Ü—é—î, —è–∫—â–æ *–≤—Å—ñ* 20 –ø–æ—Å—Ç—ñ–≤ –Ω–æ–≤—ñ—à—ñ –∑–∞ 24 –≥–æ–¥–∏–Ω–∏
        insights.append({
            'type': 'suggestion',
            'text': '–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤ (–≤—Å—ñ –ø–æ—Å—Ç–∏ –Ω–æ–≤—ñ—à—ñ –∑–∞ 24 –≥–æ–¥–∏–Ω–∏). –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.'
        })


    # 5. –ê–Ω–∞–ª—ñ–∑ Top/Flop
    if data.get('top_posts') and data.get('flop_posts'):
        insights.append({
            'type': 'suggestion',
            'text': '–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –≤–∞—à—ñ "Top" —Ç–∞ "Flop" –ø–æ—Å—Ç–∏. –¶–µ –ø—Ä—è–º–∞ –ø—ñ–¥–∫–∞–∑–∫–∞ –≤—ñ–¥ –≤–∞—à–æ—ó –∞—É–¥–∏—Ç–æ—Ä—ñ—ó, —è–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —ó–º –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è, –∞ —è–∫–∏–π - –Ω—ñ.'
        })

    return insights